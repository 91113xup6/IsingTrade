<!DOCTYPE html>

<style>
  body {
  font: Georgia, "Cambria", 18px serif;
  background-color: #999999;
  shape-rendering: crispEdges;
  }

  .spin {
  fill: #fff;
  stroke: #ccc;
  }
  
  .posi{
  fill: #fff;
  stroke: #ccc;
  }

  .value {
  fill: none;
  stroke: #000;
  stroke-width: 2px;
  }


.RdYlGn .q1{fill:rgb(165,0,38)}
.RdYlGn .q0{fill:rgb(0,104,55)}
.BW .t0{fill:rgb(255,255,255)}
.BW .t1{fill:rgb(230,230,230)}
.BW .t2{fill:rgb(205,205,205)}
.BW .t3{fill:rgb(180,180,180)}
.BW .t4{fill:rgb(155,155,155)}
.BW .t5{fill:rgb(130,130,130)}
.BW .t6{fill:rgb(105,105,105)}
.BW .t7{fill:rgb(80,80,80)}
.BW .t8{fill:rgb(55,55,55)}
.BW .t9{fill:rgb(0,0,0)}
</style>
<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="sockjs-0.3.js"></script>
<html>
  <head>
	<title>PhysCamp</title>
	<link rel="stylesheet" href="css/style.css" media="screen" type="text/css" />
	<!-- <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css"> -->
	<!-- <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css"> -->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<!-- <script src="d3.min.js"></script> -->
	
	
	<!-- <script src="fancy.js"></script> -->
	<script src="client.js"></script>
	<script type="text/javascript">
        $(function () {
            var $log = $('#log');
            var log = function (message) {
                if (console && console.log) {
                    console.log(message);
                }
                $log.append($('<li></li>').text(message))
            }

            var State = {
                isConnected: false,
                connected: function () {
                    this.isConnected = true;
                    $('#connect').attr('disabled', true);
                    $('#disconnect').attr('disabled', false);
                    $('#send').attr('disabled', false);
                    $('#status').html("Connected");

                },

                disconnected: function () {
                    this.isConnected = false;
                    $('#connect').attr('disabled', false);
                    $('#disconnect').attr('disabled', true);
                    $('#send').attr('disabled', true);
                    $('#status').html("Disconnected");
                }
            };

            var Connection = {
                socket: null,
                connect: function () {
                    var socket = this.socket = new SockJS(location.protocol + '//' + location.host + '/');
                    socket.onopen = function () {
                        log('Connection opened');
                        log('Sending: echo');
                        socket.send("echo");
                        State.connected();
                    };
                    socket.onmessage = function (e) {
                        log('Recieved: ' + e.data);
                    }
                    socket.onclose = function () {
                        log('Connection closed');
                        State.disconnected();
                    }
                },
                disconnect: function () {
                    if (this.socket) {
                        this.socket.close()
                        this.socket = null;
                    }
                },
                send: function (message) {
                    log("Sending: " + message)
                    this.socket.send(message);
                }
            }


            var $message = $('#message')
            $('#send-form').submit(function (e) {
                Connection.send($message.val());
                e.preventDefault();
            });

            $('#connect').click(function (e) {
                Connection.connect();
                e.preventDefault();
            });

            $('#disconnect').click(function (e) {
                Connection.disconnect();
                e.preventDefault();
            });

        });
    </script>

  </head>
  <body onload="Init();">
	<script src="connection.js"></script>
  </body>
</html>
